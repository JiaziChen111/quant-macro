clear
beta = 0.98;
r = 1/beta - 1;
a = 0.36;
z = 1;

N = 101;
k_ss = (beta * a).^(1 / (a - 1));
K = [(0.8 * k_ss):1/(N - 1):(1.2 * k_ss)];

C = (K.^a);
V(:) = log(C .*(C > 0));

err_crit = 1;
while (err_crit > 0.00001)
    for i = 1:N
        C = ((K(i)).^a) - K;
        U = log(C .*(C > 0) ) + beta * V(:);
        [Ustar jstar] = max(U);
        TV(i) = Ustar;
        
        indxg(i) = jstar;
    end
    
    err_crit = max(abs(V - TV));
    V = TV;
end

KPRIME = K(indxg)
clf
